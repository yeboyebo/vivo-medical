!function(t,i,e){"function"==typeof define&&define.amd?define("TatsuCarousel",i):"object"==typeof module&&module.exports?module.exports=i(e):t.TatsuCarousel=i(e)}(window,function(s){function a(t){null==t||t.hasClass("slider-initialized")||(s.fn.hasOwnProperty("flickity")?null!=t&&t instanceof s?(this.ele=t,this.prevWidth=window.innerWidth,this.bindMethods(),this.setFlickitySettings(),this.initLazyLoad(),this.initFullscreenSlider(),this.initVariableSlider(),this.initDestroyInMobile(),this.initEvents(),this.adjustArrows(),this.initFlickity()):console.error("Invalid Arg passed to TatsuCarousel"):console.error("Flickity is not added. TatsuCarousel depends on Flickity"))}var l=s(window);return a.prototype.initFullscreenSlider=function(){var t,i,e,a;"1"===this.ele.attr("data-fullscreen")&&(767<window.innerWidth||null==this.ele.attr("data-destroy-in-mobile")&&null==this.ele.attr("data-variable-width"))&&(t=this.ele.attr("data-fullscreen-offset"),i=l.height(),e=this.ele.find(".tatsu-carousel-col-inner"),a=0,"string"==typeof t&&t.split(",").forEach(function(t){var i=s(t);0<t.length&&(a+=i.height())}),e.css("height",i-a+"px"))},a.prototype.updateFullscreenSlider=function(){var t,i,e,a;(767<window.innerWidth||null==this.ele.attr("data-destroy-in-mobile")&&null==this.ele.attr("data-variable-width"))&&(t=this.ele.attr("data-fullscreen-offset"),i=l.height(),e=this.ele.find(".tatsu-carousel-col-inner"),a=0,"string"==typeof t&&t.split(",").forEach(function(t){var i=s(t);0<t.length&&(a+=i.height())}),e.css("height",i-a+"px"))},a.prototype.adjustArrows=function(){var t;!0===this.settings.prevNextButtons&&null!=this.ele.attr("data-outer-arrows")&&s(window).width()>this.ele.width()&&(t=(isNaN(parseInt(this.ele.attr("data-gutter")))?0:parseInt(this.ele.attr("data-gutter")))/2+50,this.ele.css({margin:"0 -"+t+"px",padding:"0 50px"}))},a.prototype.bindMethods=function(){this.lazyLoad=this.lazyLoad.bind(this),this.throttledLazyLoad="function"==typeof s.throttle?s.throttle(this.lazyLoad,200):this.lazyLoad,this.flickityInit=this.flickityInit.bind(this),this.updateVariableSlider=this.updateVariableSlider.bind(this),this.updateFullscreenSlider=this.updateFullscreenSlider.bind(this),this.destroyInMobile=this.destroyInMobile.bind(this),this.lazyLoadOnScroll=this.lazyLoadOnScroll.bind(this),this.updatePreviousWidth=this.updatePreviousWidth.bind(this)},a.prototype.setFlickitySettings=function(){this.settings=null;var t={};"1"==this.ele.attr("data-center-mode")&&(t.cellAlign="center"),"1"==this.ele.attr("data-autoplay")&&(t.autoPlay=isNaN(Number(this.ele.attr("data-autoplay-speed")))?3e3:Number(this.ele.attr("data-autoplay-speed"))),"1"==this.ele.attr("data-dots")&&(t.pageDots=!0),"1"===this.ele.attr("data-destroy-in-mobile")&&(t.watchCSS=!0),"1"==this.ele.attr("data-arrows")&&(t.prevNextButtons=!0),"1"==this.ele.attr("data-variable-width")&&(window.innerWidth<=767?t.adaptiveHeight=!0:t.percentPosition=!1),"1"==this.ele.attr("data-infinite")&&(t.wrapAround=!0),"1"==this.ele.attr("data-free-scroll")&&(t.freeScroll=!0),this.settings=s.extend({contain:!0,wrapAround:!1,watchCSS:!1,percentPosition:!0,cellAlign:"left",adaptiveHeight:!1,pageDots:!1,prevNextButtons:!1,autoPlay:!1,freeScroll:!1},t)},a.prototype.getMaxHeight=function(){var i=0;return this.ele.find(".tatsu-carousel-col-inner").each(function(){var t=s(this);i<t.height()&&(i=t.height())}),i},a.prototype.initEqualHeightSlider=function(){var t;"1"===this.ele.attr("data-equal-height")&&(t=this.getMaxHeight(),this.ele.find(".tatsu-carousel-col-inner").height(t),this.ele.addClass("tatsu-equal-height-slider"))},a.prototype.initDestroyInMobile=function(){var t;"1"===this.ele.attr("data-destroy-in-mobile")&&window.innerWidth<768&&"1"===this.ele.attr("data-lazy-load")&&((t=this.ele.find(".tatsu-carousel-col-inner")).css("height","auto"),t.each(function(){var t=s(this),i=t.find(".tatsu-carousel-img").attr("data-aspect-ratio")||1;null!=i&&t.height(t.width()/i)}))},a.prototype.lazyLoadOnScroll=function(){var t;0<this.imagesToLazyLoad.length&&(0<(t=this.imagesToLazyLoad.parent().filter(function(){return s(this).isVisible(-100)})).length&&this.loadImages(t.find(".tatsu-carousel-img-lazy-load")))},a.prototype.destroyInMobile=function(){var t=window.innerWidth,i=this.ele.find(".tatsu-carousel-col-inner");this.prevWidth<=767&&767<t?(i.css("height",""),l.off("scroll",this.lazyLoadOnScroll)):767<this.prevWidth&&t<=767?(i.css("width",""),i.each(function(){var t=s(this),i=t.find(".tatsu-carousel-img").attr("data-aspect-ratio")||1;null!=i&&t.height(t.width()/i)}),0<this.imagesToLazyLoad.length&&l.on("scroll",this.lazyLoadOnScroll)):t<768&&(i.each(function(){var t=s(this),i=t.find(".tatsu-carousel-img").attr("data-aspect-ratio")||1;null!=i&&t.height(t.width()/i)}),0<this.imagesToLazyLoad.length&&l.on("scroll",this.lazyLoadOnScroll))},a.prototype.initVariableSlider=function(){var t,e;"1"===this.ele.attr("data-variable-width")&&(t=this.ele.find(".tatsu-carousel-col-inner"),e=t.height(),768<=window.innerWidth?t.each(function(){var t=s(this),i=t.find(".tatsu-carousel-img").attr("data-aspect-ratio")||1;null!=i&&t.width(e*i)}):null==this.ele.attr("data-destroy-in-mobile")&&t.each(function(){var t=s(this),i=t.find(".tatsu-carousel-img").attr("data-aspect-ratio");null!=i&&t.height(t.width()/i)}))},a.prototype.updateVariableSlider=function(){var t=this.ele.find(".tatsu-carousel-col-inner"),i=window.innerWidth,e=t.height();null==this.ele.attr("data-destroy-in-mobile")?(this.prevWidth<=767&&767<i||767<this.prevWidth&&i<=767?(this.destroy(),new a(this.ele)):768<=window.innerWidth?t.each(function(){var t=s(this),i=t.find(".tatsu-carousel-img").attr("data-aspect-ratio");null!=i&&t.width(e*i)}):(t.css("width",""),t.each(function(){var t=s(this),i=t.find(".tatsu-carousel-img").attr("data-aspect-ratio");null!=i&&t.height(t.width()/i)})),this.ele.hasClass("flickity-enabled")&&this.ele.flickity("reposition")):768<=window.innerWidth?(t.each(function(){var t=s(this),i=t.find(".tatsu-carousel-img").attr("data-aspect-ratio");null!=i&&t.width(e*i)}),this.ele.hasClass("flickity-enabled")&&this.ele.flickity("reposition")):null==this.ele.attr("data-lazy-load")&&t.css("width","")},a.prototype.flickityInit=function(){"1"===this.ele.attr("data-lazy-load")&&this.lazyLoad(),this.ele.addClass("tatsu-carousel-initialized")},a.prototype.updatePreviousWidth=function(){this.prevWidth=window.innerWidth},a.prototype.initEvents=function(){this.ele.on("ready.flickity",this.flickityInit),"1"===this.ele.attr("data-lazy-load")&&this.ele.on("scroll.flickity",this.throttledLazyLoad),"1"===this.ele.attr("data-destroy-in-mobile")&&"1"===this.ele.attr("data-lazy-load")&&(window.innerWidth<768&&(l.on("scroll",this.lazyLoadOnScroll),this.lazyLoadOnScroll()),l.on("debouncedresize",this.destroyInMobile)),"1"===this.ele.attr("data-fullscreen")&&l.on("debouncedresize",this.updateFullscreenSlider),"1"===this.ele.attr("data-variable-width")&&l.on("debouncedresize",this.updateVariableSlider),l.on("debouncedresize",this.updatePreviousWidth)},a.prototype.removeEvents=function(){this.ele.off("ready.flickity",this.flickityInit),"1"===this.ele.attr("data-lazy-load")&&this.ele.off("scroll.flickity",this.throttledLazyLoad),"1"===this.ele.attr("data-destroy-in-mobile")&&"1"===this.ele.attr("data-lazy-load")&&(l.off("scroll",this.lazyLoadOnScroll),l.off("debouncedresize",this.destroyInMobile)),"1"===this.ele.attr("data-fullscreen")&&l.off("debouncedresize",this.updateFullscreenSlider),"1"===this.ele.attr("data-variable-width")&&l.off("debouncedresize",this.updateVariableSlider),l.off("debouncedresize",this.updatePreviousWidth)},a.prototype.destroy=function(){this.ele.find(".tatsu-carousel-col-inner").css({height:"",width:""}),this.removeEvents(),this.ele.flickity("destroy"),this.ele.removeClass("tatsu-carousel-initialized")},a.prototype.initLazyLoad=function(){this.imagesToLazyLoad=null,"1"===this.ele.attr("data-lazy-load")&&(this.imagesToLazyLoad=this.ele.find(".tatsu-carousel-img-lazy-load"))},a.prototype.getDoppelgangers=function(t){var i=[],e=s();return 0<this.imagesToLazyLoad.length&&(t.each(function(){i.push(s(this).attr("data-src"))}),this.imagesToLazyLoad.each(function(){var t=s(this);0<t.length&&null==t.attr("src")&&-1<i.indexOf(t.attr("data-src"))&&(e=e.add(t))})),e},a.prototype.loadImages=function(t){var i=this.ele.hasClass("tatsu-carousel-adaptive-image");t.one("load",function(){s(this).addClass("tatsu-carousel-img-lazy-loaded")}).each(function(){var t=s(this);i?t.attr("srcset",t.attr("data-srcset")):t.attr("src",t.attr("data-src"))}),this.imagesToLazyLoad=this.imagesToLazyLoad.not(t),0==this.imagesToLazyLoad.length&&this.ele.off("scroll.flickity",this.throttledLazyLoad)},a.prototype.getVisibleSlides=function(){var t=this.ele.find(".flickity-viewport"),i=t.offset().left,e=i,a=i+t.width();return this.imagesToLazyLoad.filter(function(){var t=s(this).parent(),i=t.offset().left,t=t.offset().left+t.outerWidth(!0);return e<t&&t<=a||i<a&&e<=i})},a.prototype.lazyLoad=function(){var t;0<this.imagesToLazyLoad.length&&(null!=(t=this.getVisibleSlides())&&0<t.length&&this.loadImages(t))},a.prototype.initFlickity=function(){this.ele.flickity(this.settings)},a},jQuery);