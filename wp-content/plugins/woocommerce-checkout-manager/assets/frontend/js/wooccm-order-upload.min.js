!function($){"use strict";var is_blocked=function($node){return $node.is(".processing")||$node.parents(".processing").length},block=function($node){is_blocked($node)||$node.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock=function($node){$node.removeClass("processing").unblock()};$(document).ready((function($){$(document).on("click",".wooccm_delete_attachment",(function(e){var $tr=$(this).closest("tr"),attachment_id=$(this).data("attachment_id");$tr.hide(),$("#wooccm_order_attachment_update").prop("disabled",!1),$("#delete_attachments_ids").val($("#delete_attachments_ids").val().replace(attachment_id,""))})),$(document).on("click","#wooccm_order_attachment_update",(function(e){$.ajax({url:wooccm_upload.ajax_url,type:"POST",cache:!1,data:{action:"wooccm_order_attachment_update",nonce:wooccm_upload.nonce,delete_attachments_ids:$("#delete_attachments_ids").val(),all_attachments_ids:$("#all_attachments_ids").val()},beforeSend:function(response){$(".wooccm_upload_results").html(wooccm_upload.message.saving)},success:function(response){response.success?($(".wooccm_upload_results").html(wooccm_upload.message.deleted),$("#wooccm_order_attachment_update").prop("disabled",!0)):$(".wooccm_upload_results").html(response.data)}})})),$(document).on("change","#wooccm_order_attachment_upload",(function(e){var data=!1,order_id=$(this).data("order_id");window.FormData&&(data=new FormData);for(var i=0,len=this.files.length,file;i<len;i++)file=this.files[i],data&&data.append("wooccm_order_attachment_upload[]",file);data&&(data.append("action","wooccm_order_attachment_upload"),data.append("nonce",wooccm_upload.nonce),data.append("order_id",order_id),$.ajax({url:wooccm_upload.ajax_url,type:"POST",cache:!1,data:data,processData:!1,contentType:!1,beforeSend:function(response){$(".wooccm_upload_results").html(wooccm_upload.message.uploading),block($(".wooccm_order_attachments_wrapper"))},success:function(response){response.success?($(".wooccm_order_attachments_wrapper").fadeOut(),$(".wooccm_order_attachments_wrapper").replaceWith($(response.data).fadeIn()),$(".wooccm_upload_results").html(wooccm_upload.message.success)):$(".wooccm_upload_results").html(response.data),unblock($(".wooccm_order_attachments_wrapper"))}}))}))}))}(jQuery);